# üîí –í–ê–ñ–õ–ò–í–û: –ë–µ–∑–ø–µ–∫–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Row Level Security (RLS) –≤ Supabase!

**–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≤ –∫–æ–¥—ñ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –ù–ï —î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ—é –∑–∞—Ö–∏—Å—Ç–æ–º!**

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ:
- –í—ñ–¥–∫—Ä–∏—Ç–∏ DevTools ‚Üí Console
- –í–∏–∫–ª–∏–∫–∞—Ç–∏ API –Ω–∞–ø—Ä—è–º—É –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
- –ó–º—ñ–Ω–∏—Ç–∏ –∫–æ–¥ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Postman –∞–±–æ —ñ–Ω—à—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

**–¢–æ–º—É –û–ë–û–í'–Ø–ó–ö–û–í–û –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ RLS –Ω–∞ —Ä—ñ–≤–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö!**

## üõ°Ô∏è –Ø–∫ –ø—Ä–∞—Ü—é—î RLS (Row Level Security)

RLS –ø—Ä–∞—Ü—é—î **–±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ PostgreSQL** —ñ **–ù–ï –ú–û–ñ–ï –ë–£–¢–ò –æ–±—ñ–π–¥–µ–Ω–æ** —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:

1. –ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç, Supabase –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞—î `WHERE user_id = auth.uid()`
2. –¶–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞ —Ä—ñ–≤–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, –ü–ï–†–ï–î —Ç–∏–º —è–∫ –¥–∞–Ω—ñ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è
3. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–¥–∞–ª–∏—Ç—å `.eq('user_id', ...)` –≤ –∫–æ–¥—ñ, RLS –≤—Å–µ –æ–¥–Ω–æ —Ñ—ñ–ª—å—Ç—Ä—É—î
4. –ù–∞–≤—ñ—Ç—å –ø—Ä—è–º—ñ SQL –∑–∞–ø–∏—Ç–∏ —á–µ—Ä–µ–∑ Supabase Dashboard –Ω–µ –º–æ–∂—É—Ç—å –æ–±—ñ–π—Ç–∏ RLS (–∫—Ä—ñ–º service role key)

## ‚úÖ –©–æ –≤–∂–µ –∑—Ä–æ–±–ª–µ–Ω–æ

1. ‚úÖ –î–æ–¥–∞–Ω–æ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é –ø–æ `user_id` –≤ –∫–æ–¥—ñ (–¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç)
2. ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ SQL —Å–∫—Ä–∏–ø—Ç `SUPABASE_RLS_SETUP.sql`
3. ‚ö†Ô∏è **–í–ò –ù–ï –í–ò–ö–û–ù–ê–õ–ò –°–ö–†–ò–ü–¢ –í SUPABASE!** ‚Üê –¶–ï –¢–†–ï–ë–ê –ó–†–û–ë–ò–¢–ò –ó–ê–†–ê–ó!

## üö® –©–û –ü–û–¢–†–Ü–ë–ù–û –ó–†–û–ë–ò–¢–ò –ó–ê–†–ê–ó:

### –ö—Ä–æ–∫ 1: –í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –∑–∞–ø–∏—Å–∏ –∑ user_id = NULL

**–°–ø–æ—á–∞—Ç–∫—É –æ—á–∏—Å—Ç—ñ—Ç—å —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ!**

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Supabase Dashboard ‚Üí **SQL Editor**
2. –°–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç –∑ `SUPABASE_CLEANUP_NULL_USER.sql`
3. –°–ø–æ—á–∞—Ç–∫—É –≤–∏–∫–æ–Ω–∞–π—Ç–µ `SELECT COUNT(*)` —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Å–∫—ñ–ª—å–∫–∏ –∑–∞–ø–∏—Å—ñ–≤
4. –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –¥–∞–Ω—ñ - –ø—Ä–∏–∑–Ω–∞—á—Ç–µ —ó—Ö –≤–∞—à–æ–º—É user_id (–¥–∏–≤. –í–ê–†–Ü–ê–ù–¢ 2 –≤ —Å–∫—Ä–∏–ø—Ç—ñ)
5. –Ø–∫—â–æ —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ - –≤–∏–¥–∞–ª—ñ—Ç—å —ó—Ö (–¥–∏–≤. –í–ê–†–Ü–ê–ù–¢ 1)

### –ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ RLS

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Supabase Dashboard ‚Üí **SQL Editor**
2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `SUPABASE_RLS_SETUP.sql` –∑ –ø—Ä–æ–µ–∫—Ç—É
3. –°–∫–æ–ø—ñ—é–π—Ç–µ **–≤–µ—Å—å –≤–º—ñ—Å—Ç** —Ñ–∞–π–ª—É
4. –í—Å—Ç–∞–≤—Ç–µ –≤ SQL Editor
5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Run** (–∞–±–æ Ctrl+Enter)

**–í–ê–ñ–õ–ò–í–û:** –¢–µ–ø–µ—Ä –ø–æ–ª—ñ—Ç–∏–∫–∏ –º–∞—é—Ç—å `AND user_id IS NOT NULL`, —Ç–æ–º—É –∑–∞–ø–∏—Å–∏ –∑ NULL –Ω–µ –±—É–¥—É—Ç—å –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏—Å—å!

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

–ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

1. **Table Editor** ‚Üí `transactions` ‚Üí **Policies** ‚Üí –º–∞—î –±—É—Ç–∏ 4 –ø–æ–ª—ñ—Ç–∏–∫–∏
2. **Table Editor** ‚Üí `cards` ‚Üí **Policies** ‚Üí –º–∞—î –±—É—Ç–∏ 4 –ø–æ–ª—ñ—Ç–∏–∫–∏
3. –í –æ–±–æ—Ö —Ç–∞–±–ª–∏—Ü—è—Ö –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ **RLS enabled** (—á–µ—Ä–≤–æ–Ω–∞ –ª–∞–º–ø–æ—á–∫–∞ —É–≤—ñ–º–∫–Ω–µ–Ω–∞)

### –ö—Ä–æ–∫ 4: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

1. –£–≤—ñ–π–¥—ñ—Ç—å –ø—ñ–¥ –æ–¥–Ω–∏–º Google –∞–∫–∫–∞—É–Ω—Ç–æ–º
2. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é/–∫–∞—Ä—Ç–∫—É
3. –í–∏–π–¥—ñ—Ç—å —Ç–∞ —É–≤—ñ–π–¥—ñ—Ç—å –ø—ñ–¥ —ñ–Ω—à–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º
4. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –ø–µ—Ä—à–∏–π –∞–∫–∫–∞—É–Ω—Ç –ù–ï –±–∞—á–∏—Ç—å –¥–∞–Ω—ñ –¥—Ä—É–≥–æ–≥–æ

## üìã –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–µ–∑–ø–µ–∫–∏

### –¢–µ—Å—Ç 1: –°–ø—Ä–æ–±—É–π—Ç–µ –æ–±—ñ–π—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é

```javascript
// –í—ñ–¥–∫—Ä–∏–π—Ç–µ Console –≤ –±—Ä–∞—É–∑–µ—Ä—ñ –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É
// –°–ø—Ä–æ–±—É–π—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó:

const { data } = await supabase
  .from('transactions')
  .select('*')
  
console.log(data) // –Ø–∫—â–æ RLS –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π, –±—É–¥–µ —Ç—ñ–ª—å–∫–∏ –≤–∞—à—ñ –¥–∞–Ω—ñ
```

### –¢–µ—Å—Ç 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ Supabase Dashboard

1. **Table Editor** ‚Üí `transactions`
2. –°–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –¥–∞–Ω—ñ
3. –Ø–∫—â–æ RLS –ø—Ä–∞—Ü—é—î, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ —Ç—ñ–ª—å–∫–∏ –≤–∞—à—ñ –∑–∞–ø–∏—Å–∏ (—è–∫—â–æ –≤–∏ —É–≤—ñ–π—à–ª–∏ —á–µ—Ä–µ–∑ Dashboard)
4. –ê–±–æ –ø–æ–º–∏–ª–∫—É, —è–∫—â–æ –Ω–µ —É–≤—ñ–π—à–ª–∏

## ‚ö†Ô∏è –©–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è, —è–∫—â–æ –ù–ï –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ RLS:

- ‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑–º–æ–∂—É—Ç—å –±–∞—á–∏—Ç–∏ –¥–∞–Ω—ñ —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑–º–æ–∂—É—Ç—å –≤–∏–¥–∞–ª—è—Ç–∏/–∑–º—ñ–Ω—é–≤–∞—Ç–∏ —á—É–∂–∏—ñ –¥–∞–Ω—ñ
- ‚ùå –î–∞–Ω—ñ –±—É–¥—É—Ç—å –≤–∏—Ç—ñ–∫–∞—Ç–∏ —á–µ—Ä–µ–∑ –ø—Ä—è–º—ñ API –∑–∞–ø–∏—Ç–∏
- ‚ùå **–¶–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –±–µ–∑–ø–µ–∫–∏!**

## ‚úÖ –ü—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è RLS:

- ‚úÖ –ù–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏–¥–∞–ª–∏—Ç–∏ `.eq('user_id', ...)` –≤ –∫–æ–¥—ñ - RLS –≤—Å–µ –æ–¥–Ω–æ —Ñ—ñ–ª—å—Ç—Ä—É—î
- ‚úÖ –ü—Ä—è–º—ñ SQL –∑–∞–ø–∏—Ç–∏ —á–µ—Ä–µ–∑ API —Ç–∞–∫–æ–∂ —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è
- ‚úÖ –î–∞–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —ñ–∑–æ–ª—å–æ–≤–∞–Ω—ñ
- ‚úÖ **–ü–æ–≤–Ω–∞ –±–µ–∑–ø–µ–∫–∞ –Ω–∞ —Ä—ñ–≤–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö**

## üéØ –ü—ñ–¥—Å—É–º–æ–∫

1. **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≤ –∫–æ–¥—ñ** = –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç + –∫—Ä–∞—â–µ UX
2. **RLS –≤ Supabase** = –û–°–ù–û–í–ù–ò–ô –∑–∞—Ö–∏—Å—Ç + –Ω–µ –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏

**–û–ë–û–í'–Ø–ó–ö–û–í–û –≤–∏–∫–æ–Ω–∞–π—Ç–µ `SUPABASE_RLS_SETUP.sql` –≤ Supabase Dashboard!**

